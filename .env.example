# =============================================================================
# Resonance - Environment Configuration
# =============================================================================
# Copy this file to .env and update the values for your environment.
# NEVER commit your .env file to version control!
#
# Required variables are marked with [REQUIRED]
# Optional variables show their default values
# =============================================================================

# -----------------------------------------------------------------------------
# Database Configuration
# -----------------------------------------------------------------------------
# [REQUIRED] Password for the PostgreSQL database user
# Generate a strong password: openssl rand -base64 24
DB_PASSWORD=your-secure-password-here

# [REQUIRED] Full PostgreSQL connection string
# Uses DB_PASSWORD variable for the password portion
DATABASE_URL=postgres://resonance:${DB_PASSWORD}@postgres:5432/resonance

# PostgreSQL user and database name (used by Docker Compose)
POSTGRES_USER=resonance
POSTGRES_DB=resonance
POSTGRES_PASSWORD=${DB_PASSWORD}

# Database connection pool settings (optional)
# DATABASE_MAX_CONNECTIONS=10
# DATABASE_MIN_CONNECTIONS=2

# -----------------------------------------------------------------------------
# Authentication & Security
# -----------------------------------------------------------------------------
# [REQUIRED] Secret key for signing JWT tokens
# MUST be at least 32 characters. Generate with: openssl rand -base64 32
JWT_SECRET=generate-with-openssl-rand-base64-32

# JWT token expiration times
# Access tokens are short-lived for security
JWT_ACCESS_EXPIRY=15m

# Refresh tokens allow users to stay logged in
JWT_REFRESH_EXPIRY=7d

# -----------------------------------------------------------------------------
# Redis Configuration
# -----------------------------------------------------------------------------
# Redis connection URL for caching, sessions, and pub/sub
# Default: redis://redis:6379
REDIS_URL=redis://redis:6379

# Optional Redis password (uncomment if your Redis instance requires auth)
# REDIS_PASSWORD=

# -----------------------------------------------------------------------------
# Meilisearch Configuration
# -----------------------------------------------------------------------------
# Meilisearch server URL for full-text search
MEILISEARCH_URL=http://meilisearch:7700

# [REQUIRED] Meilisearch master key for authentication
# Generate with: openssl rand -base64 32
MEILISEARCH_KEY=your-meilisearch-master-key

# Meilisearch environment mode
MEILI_ENV=production

# -----------------------------------------------------------------------------
# Ollama AI Configuration
# -----------------------------------------------------------------------------
# Ollama server URL for AI-powered features (recommendations, mood detection)
# Default: http://ollama:11434
OLLAMA_URL=http://ollama:11434

# LLM model for natural language search and recommendations
# Popular options: mistral, llama2, codellama, mixtral
# Default: mistral
OLLAMA_MODEL=mistral

# Embedding model for semantic search and vector similarity
# Must be an embedding-capable model
EMBEDDING_MODEL=nomic-embed-text

# -----------------------------------------------------------------------------
# Lidarr Integration
# -----------------------------------------------------------------------------
# [REQUIRED] Lidarr instance URL for automatic music library management
LIDARR_URL=http://lidarr:8686

# [REQUIRED] Lidarr API key (found in Lidarr -> Settings -> General -> Security)
LIDARR_API_KEY=your-lidarr-api-key

# -----------------------------------------------------------------------------
# Music Library
# -----------------------------------------------------------------------------
# [REQUIRED] Absolute path to your music library directory
# This should match the path configured in Lidarr
MUSIC_LIBRARY_PATH=/path/to/your/music

# Supported audio formats (comma-separated, for reference)
# Resonance supports: flac, mp3, m4a, ogg, opus, wav, aiff, wma

# -----------------------------------------------------------------------------
# Server Configuration
# -----------------------------------------------------------------------------
# API server port (4440 = A440 Hz, the standard musical tuning pitch)
# Default: 4440
PORT=4440

# Rust logging configuration
# Levels: error, warn, info, debug, trace
# Can be module-specific: resonance_api=debug,sqlx=warn
# Default: info
RUST_LOG=info

# Environment mode (development, staging, production)
# Affects logging verbosity, error messages, and debug features
ENVIRONMENT=development

# API host binding (0.0.0.0 for all interfaces)
# HOST=0.0.0.0

# -----------------------------------------------------------------------------
# CORS Configuration
# -----------------------------------------------------------------------------
# Allowed origins for CORS (comma-separated)
# [REQUIRED in production] Must be explicitly set to prevent permissive CORS
# In development, if not set, permissive CORS is used for convenience
# Example: http://localhost:5173,http://localhost:8080
# CORS_ORIGINS=http://localhost:5173,https://your-domain.com

# -----------------------------------------------------------------------------
# External Integrations (Optional)
# -----------------------------------------------------------------------------
# ListenBrainz - Scrobbling and listening history
# Get your token at: https://listenbrainz.org/profile/
LISTENBRAINZ_API_KEY=

# Discord Rich Presence - Show what you're listening to
# Create an application at: https://discord.com/developers/applications
DISCORD_CLIENT_ID=

# Last.fm scrobbling (optional alternative to ListenBrainz)
# LASTFM_API_KEY=
# LASTFM_API_SECRET=

# -----------------------------------------------------------------------------
# Audio Transcoding
# -----------------------------------------------------------------------------
# Maximum transcoding quality in kbps (128, 192, 256, 320)
# Higher values = better quality but more bandwidth
# Default: 320
MAX_TRANSCODE_QUALITY=320

# Transcode cache size in gigabytes
# Transcoded files are cached to reduce CPU usage
# Default: 10
TRANSCODE_CACHE_SIZE_GB=10

# Enable hardware-accelerated transcoding if available
# HARDWARE_TRANSCODE_ENABLED=false

# -----------------------------------------------------------------------------
# Recommendations & Discovery
# -----------------------------------------------------------------------------
# Number of tracks in weekly discovery playlist
# Default: 30
WEEKLY_PLAYLIST_SIZE=30

# Automatically download tracks for autoplay queue
# Ensures seamless playback even with slow connections
# Default: true
AUTOPLAY_DOWNLOAD_ENABLED=true

# Number of tracks to pre-download for autoplay
# AUTOPLAY_PREFETCH_COUNT=5

# Similarity threshold for recommendations (0.0 - 1.0)
# Higher values = more similar recommendations
# RECOMMENDATION_SIMILARITY_THRESHOLD=0.7

# -----------------------------------------------------------------------------
# PWA & Offline
# -----------------------------------------------------------------------------
# Maximum offline cache size in gigabytes per user
# OFFLINE_CACHE_MAX_SIZE_GB=10

# Auto-download quality for offline playback (low, medium, high, original)
# OFFLINE_DOWNLOAD_QUALITY=high

# -----------------------------------------------------------------------------
# Rate Limiting
# -----------------------------------------------------------------------------
# Rate limit for authentication endpoints (requests per minute)
# AUTH_RATE_LIMIT=10

# Rate limit for API endpoints (requests per minute)
# API_RATE_LIMIT=100

# Rate limit for streaming endpoints (requests per minute)
# STREAM_RATE_LIMIT=60

# -----------------------------------------------------------------------------
# Worker Configuration
# -----------------------------------------------------------------------------
# Number of background worker threads
# WORKER_THREADS=4

# Job retry attempts before marking as failed
# WORKER_MAX_RETRIES=3

# Interval between recommendation updates (cron syntax)
# RECOMMENDATION_UPDATE_SCHEDULE=0 4 * * *

# -----------------------------------------------------------------------------
# Monitoring & Observability (Optional)
# -----------------------------------------------------------------------------
# Enable Prometheus metrics endpoint at /metrics
# METRICS_ENABLED=false

# OpenTelemetry collector endpoint for distributed tracing
# OTEL_EXPORTER_OTLP_ENDPOINT=

# Sentry DSN for error tracking
# SENTRY_DSN=

# -----------------------------------------------------------------------------
# Development Only
# -----------------------------------------------------------------------------
# Enable development features (hot reload, verbose errors, etc.)
# DEV_MODE=true

# Disable authentication for local development (NEVER use in production!)
# DEV_SKIP_AUTH=false

# Seed database with sample data on startup
# DEV_SEED_DATABASE=false
